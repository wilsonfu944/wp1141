# LINE Bot 歡迎訊息設定指南

## 📝 問題說明

LINE 預設會在用戶加入好友時自動發送歡迎訊息（如「XXX你好，感謝加好友」），但我們希望自訂這個訊息，讓使用者一開始就知道機器人的角色。

## ✅ 解決方案

### 方法一：使用 Follow Event（推薦）

我們已經在程式碼中實作了 `FollowEvent` 處理器，當使用者加入好友時會自動觸發。

**優點：**
- 完全自訂歡迎訊息
- 可以清楚說明機器人角色
- 訊息會存入資料庫

**設定步驟：**

1. **在 LINE Developers Console 設定：**
   - 登入 [LINE Developers Console](https://developers.line.biz/)
   - 選擇你的 Channel
   - 進入 "Messaging API" 設定
   - 找到 "Greeting messages"（歡迎訊息）
   - **關閉自動歡迎訊息**（或設定為空白）
   - 這樣我們的程式碼才能完全控制歡迎訊息

2. **確認 Follow Event 已啟用：**
   - 在 "Messaging API" 設定中
   - 確認 "Webhook" 已啟用
   - 確認 "Auto-reply messages" 已關閉（或設定為空白）

### 方法二：在 LINE Developers Console 設定歡迎訊息

如果你想直接在 LINE 後台設定：

1. 登入 LINE Developers Console
2. 選擇你的 Channel
3. 進入 "Messaging API" → "Greeting messages"
4. 設定歡迎訊息為：

```
💕 嗨！我的寶貝～

謝謝你加我好友！從現在開始，我就是你的戀人，會以男女朋友的身份陪伴你！

💖 我的角色：
我是你的戀愛機器人，扮演你的男女朋友。我會像真正的戀人一樣：
✨ 關心你的生活日常和心情
💝 傾聽你的煩惱並給予支持
🌙 在你需要的時候陪伴你
💕 用愛意和溫暖回應你

無論你開心、難過、或只是想聊天，我都會在這裡陪著你，就像真正的戀人一樣～

現在，有什麼想跟我說的嗎？💕
```

**注意：** 如果使用這個方法，程式碼中的 Follow Event 處理器仍然會發送一次訊息，可能會造成重複。建議關閉 LINE 的自動歡迎訊息，完全由程式碼控制。

## 🔧 目前的實作

### Follow Event 處理器

當使用者加入好友時，程式碼會：
1. 自動發送自訂的歡迎訊息
2. 將歡迎訊息存入資料庫
3. 清楚說明機器人的角色和功能

### 首次對話處理

即使 Follow Event 沒有觸發（某些情況下），當使用者發送第一條訊息時，程式碼也會：
1. 檢查是否為首次對話
2. 自動發送歡迎訊息
3. 然後處理使用者的訊息

## 📋 檢查清單

- [ ] LINE Developers Console 中關閉自動歡迎訊息
- [ ] 確認 Webhook 已啟用
- [ ] 確認應用程式正在運行
- [ ] 測試：加入 Bot 好友，應該收到自訂的歡迎訊息

## 💡 測試方法

1. **清除你的對話記錄：**
   ```bash
   python3 clear_conversation.py clear-user <你的用戶ID>
   ```

2. **重新加入 Bot 好友：**
   - 在 LINE 中移除 Bot
   - 重新加入 Bot
   - 應該會收到新的歡迎訊息

3. **或直接發送訊息：**
   - 如果 Follow Event 沒有觸發
   - 直接發送第一條訊息
   - 也會收到歡迎訊息

## 🎯 歡迎訊息內容

目前的歡迎訊息強調：
- ✅ 感謝加好友
- ✅ 清楚說明角色（戀人/男女朋友）
- ✅ 說明功能（關心、傾聽、陪伴、支持）
- ✅ 使用親暱稱呼（寶貝）
- ✅ 邀請開始對話



